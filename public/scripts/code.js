$(document).ready(function(){theWebcomicShelf.init()});var theWebcomicShelf={init:function(){this.updateAddBtnState(),this.initLocalStorageDetection(),this.initComicSelector(),this.initComicsSelectorWrapper(),this.initSortableComicsList(),this.initAddComicButton(),this.initDeleteComicButton(),this.initUserComics()},initLocalStorageDetection:function(){this.isLocalStorageSupported()||$("#errorContainer").css("display","table")},initComicSelector:function(){$("#comicsSelector").val($("#comicsSelector option:first").val()),$("#comicsSelector").change(function(){theWebcomicShelf.updateAddBtnState()})},initComicsSelectorWrapper:function(){$(document).click(function(){$("#comicsSelectorWrapper ul:visible").hide()}),$("#comicsSelectorWrapper #chooseComicBtn").click(function(i){$("#comicsSelectorWrapper ul").toggle(),i.stopPropagation()}),$("#comicsSelectorWrapper ul li").click(function(i){$("#comicsSelector").val($(i.target).closest("li").data("value")).change(),$("#comicsSelectorWrapper #chooseComicBtn span.btnContent").text($(i.target).closest("li").text())})},initSortableComicsList:function(){$("#comicsList").sortable({handle:".header",stop:function(i,t){$("#comicsList").css("height","auto"),t.item.children(".comicContainer").children(".comic").show(),userComics=[],$("#comicsList li").each(function(){userComics.push($(this).attr("id"))}),localStorage.userComics=JSON.stringify(userComics)}}),$("#comicsList").on("mousedown",".header",function(i){1==i.which&&($("#comicsList").css("height",$("#comicsList").outerHeight(!0)),$(this).closest("li").children(".comicContainer").children(".comic").hide())}),$("#comicsList").on("mouseup",".header",function(){$("#comicsList").css("height","auto"),$(this).closest("li").children(".comicContainer").children(".comic").show()})},initAddComicButton:function(){var i=this.getUserComics();$("#addComicBtn").click(function(){$("#addComicBtn").hide(),$("#comicAddedBtn").show();var t=$("#comicsSelector").val(),c=$("#comicsSelector").children(":selected").text(),o=$("#placeholder").clone();o.attr("id",t),o.find(".header h2").text(c),$("#comicsList").append(o),i.push(t),localStorage.userComics=JSON.stringify(i),$.ajax({url:"comic/"+t,dataType:"html"}).done(function(i){$("#comicsList #"+t).html(i)})})},initDeleteComicButton:function(){$("#comicsList").on("click",".deleteComicBtn",function(){var i=$(this).closest("li").attr("id");$(this).closest("li").remove(),userComics=[],$("#comicsList li").each(function(){userComics.push($(this).attr("id"))}),localStorage.userComics=JSON.stringify(userComics),$("#comicsSelector").val()==i&&($("#comicAddedBtn").hide(),$("#addComicBtn").show())})},getUserComics:function(){return"undefined"!=typeof localStorage.userComics?JSON.parse(localStorage.userComics):[]},updateAddBtnState:function(){var i=this.getUserComics(),t=$("#comicsSelector").val();-1!==$.inArray(t,i)?($("#addComicBtn").hide(),$("#comicAddedBtn").show()):($("#addComicBtn").show(),$("#comicAddedBtn").hide())},initUserComics:function(){for(var i=this.getUserComics(),t=0;t<i.length;t++){var c=i[t],o=$("#comicsSelector").children("[value="+c+"]").text();!function(i){var t=$("#placeholder").clone();t.attr("id",i),t.find(".header h2").text(o),$("#comicsList").append(t),$.ajax({url:"comic/"+i,dataType:"html"}).done(function(t){$("#comicsList #"+i).html(t)})}(c)}},isLocalStorageSupported:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(i){return!1}}};